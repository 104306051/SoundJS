/**
* SoundJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011 gskinner.com, inc.
* 
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
**/
this.createjs=this.createjs||{};
(function(){function b(){throw"SoundJS cannot be instantiated";}function f(a,c){this.init(a,c)}function i(){}b.VERSION="0.3.1";b.DELIMITER="|";b.AUDIO_TIMEOUT=8E3;b.INTERRUPT_ANY="any";b.INTERRUPT_EARLY="early";b.INTERRUPT_LATE="late";b.INTERRUPT_NONE="none";b.PLAY_INITED="playInited";b.PLAY_SUCCEEDED="playSucceeded";b.PLAY_INTERRUPTED="playInterrupted";b.PLAY_FINISHED="playFinished";b.PLAY_FAILED="playFailed";b.SUPPORTED_EXTENSIONS="mp3,ogg,mpeg,wav,m4a,mp4,aiff,wma,mid".split(",");b.EXTENSION_MAP=
{m4a:"mp4"};b.FILE_PATTERN=/(\w+:\/{2})?((?:\w+\.){2}\w+)?(\/?[\S]+\/|\/)?([\w\-%]+)(?:\.)(\w+)?(\?\S+)?/i;b.lastId=0;b.activePlugin=null;b.masterMute=false;b.pluginsRegistered=false;b.masterVolume=1;b.instances=[];b.idHash={};b.preloadHash={};b.defaultSoundInstance=null;b.addEventListener=null;b.removeEventListener=null;b.removeAllEventListeners=null;b.dispatchEvent=null;b.hasEventListener=null;b._listeners=null;createjs.EventDispatcher&&createjs.EventDispatcher.initialize(b);b.getPreloadHandlers=
function(){return{callback:b.proxy(b.initLoad,b),types:["sound"],extensions:b.SUPPORTED_EXTENSIONS}};b.registerPlugin=function(a){b.pluginsRegistered=true;if(a==null)return false;return a.isSupported()?(b.activePlugin=new a,true):false};b.registerPlugins=function(a){for(var c=0,e=a.length;c<e;c++)if(b.registerPlugin(a[c]))return true;return false};b.initializeDefaultPlugins=function(){return b.activePlugin!=null?true:b.pluginsRegistered?false:b.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin])?
true:false};b.isReady=function(){return b.activePlugin!=null};b.getCapabilities=function(){return b.activePlugin==null?null:b.activePlugin.capabilities};b.getCapability=function(a){return b.activePlugin==null?null:b.activePlugin.capabilities[a]};b.initLoad=function(a,c,e,d){a=b.registerSound(a,e,d,false);return a==null?false:a};b.registerSound=function(a,c,e,d){if(!b.initializeDefaultPlugins())return false;if(a instanceof Object)a=a.src,c=a.id,e=a.data;var g=b.parsePath(a,"sound",c,e);if(g==null)return false;
if(c!=null)b.idHash[c]=g.src;var h=1;e!=null&&(isNaN(e.channels)?isNaN(e)||(h=parseInt(e)):h=parseInt(e.channels));f.create(g.src,h);h=b.activePlugin.register(g.src,h);if(h!=null){if(h.tag!=null)g.tag=h.tag;else if(h.src)g.src=h.src;if(h.completeHandler!=null)g.completeHandler=h.completeHandler;g.type=h.type}d!=false&&(b.preloadHash[g.src]={src:a,id:c,data:e},b.activePlugin.preload(g.src,h));return g};b.registerManifest=function(a){for(var c=[],b=0,d=a.length;b<d;b++)c[b]=createjs.SoundJS.registerSound(a[b].src,
a[b].id,a[b].data,a[b].preload);return c};b.loadComplete=function(a){var c=b.parsePath(a,"sound"),a=c?b.getSrcById(c.src):b.getSrcById(a);return b.preloadHash[a]==true};b.onLoadComplete=null;b.sendLoadComplete=function(a){var c={target:this,type:"loadComplete",src:b.preloadHash[a].src,id:b.preloadHash[a].id,data:b.preloadHash[a].data};b.preloadHash[a]=true;b.onLoadComplete&&b.onLoadComplete(c);b._listeners&&b.dispatchEvent(c)};b.parsePath=function(a,c,e,d){for(var a=a.split(b.DELIMITER),c={type:c||
"sound",id:e,data:d},e=b.getCapabilities(),d=0,g=a.length;d<g;d++){var h=a[d],f=h.match(b.FILE_PATTERN);if(f==null)return false;var i=f[4],f=f[5];if(e[f]&&b.SUPPORTED_EXTENSIONS.indexOf(f)>-1)return c.name=i,c.src=h,c.extension=f,c}return null};b.play=function(a,c,e,d,g,h,f){a=b.createInstance(a);b.playInstance(a,c,e,d,g,h,f)||a.playFailed();return a};b.createInstance=function(a){if(!b.initializeDefaultPlugins())return b.defaultSoundInstance;var c=b.parsePath(a,"sound"),a=c?b.getSrcById(c.src):b.getSrcById(a),
c=a.lastIndexOf("."),e=a.slice(c+1);c!=-1&&b.SUPPORTED_EXTENSIONS.indexOf(e)>-1?(f.create(a),a=b.activePlugin.create(a)):a=b.defaultSoundInstance;a.uniqueId=b.lastId++;return a};b.setVolume=function(a){if(Number(a)==null)return false;a=Math.max(0,Math.min(1,a));b.masterVolume=a;if(!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(a))for(var c=0,e=this.instances.length;c<e;c++)this.instances[c].setMasterVolume(a)};b.getVolume=function(){return b.masterVolume};b.mute=function(a){this.masterMute=
a;if(!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(a))for(var c=0,b=this.instances.length;c<b;c++)this.instances[c].setMasterMute(a)};b.setMute=function(a){if(a==null||a==void 0)return false;this.masterMute=a;if(!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(a))for(var c=0,b=this.instances.length;c<b;c++)this.instances[c].setMasterMute(a);return true};b.getMute=function(){return this.masterMute};b.stop=function(){for(var a=this.instances.length;a>
0;a--)this.instances[a-1].stop()};b.playInstance=function(a,c,e,d,g,h,f){c=c||b.INTERRUPT_NONE;e==null&&(e=0);d==null&&(d=a.getPosition());g==null&&(g=0);h==null&&(h=a.getVolume());f==null&&(f=a.getPan());if(e==0){if(!b.beginPlaying(a,c,d,g,h,f))return false}else e=setTimeout(function(){b.beginPlaying(a,c,d,g,h,f)},e),a.delayTimeoutId=e;this.instances.push(a);return true};b.beginPlaying=function(a,c,b,d,g,h){if(!f.add(a,c))return false;return!a.beginPlaying(b,d,g,h)?(a=this.instances.indexOf(a),a>
-1&&this.instances.splice(a,1),false):true};b.getSrcById=function(a){return b.idHash==null||b.idHash[a]==null?a:b.idHash[a]};b.playFinished=function(a){f.remove(a);a=this.instances.indexOf(a);a>-1&&this.instances.splice(a,1)};b.proxy=function(a,c){return function(){return a.apply(c,arguments)}};createjs.SoundJS=b;f.channels={};f.create=function(a,c){var b=f.get(a);c==null&&(c=1);return b==null?(f.channels[a]=new f(a,c),true):false};f.add=function(a,c){var b=f.get(a.src);return b==null?false:b.add(a,
c)};f.remove=function(a){var c=f.get(a.src);if(c==null)return false;c.remove(a);return true};f.get=function(a){return f.channels[a]};f.prototype={src:null,max:null,length:0,init:function(a,c){this.src=a;this.max=c||1;this.instances=[]},get:function(a){return this.instances[a]},add:function(a,c){if(!this.getSlot(c,a))return false;this.instances.push(a);this.length++;return true},remove:function(a){a=this.instances.indexOf(a);if(a==-1)return false;this.instances.splice(a,1);this.length--;return true},
getSlot:function(a){for(var c,e,d=0,g=this.max||100;d<g;d++){c=this.get(d);if(c==null)return true;else if(a==b.INTERRUPT_NONE&&c.playState!=b.PLAY_FINISHED)continue;if(d==0)e=c;else if(c.playState==b.PLAY_FINISHED||c==b.PLAY_INTERRUPTED||c==b.PLAY_FAILED)e=c;else if(a==b.INTERRUPT_EARLY&&c.getPosition()<e.getPosition()||a==b.INTERRUPT_LATE&&c.getPosition()>e.getPosition())e=c}return e!=null?(e.interrupt(),this.remove(e),true):false},toString:function(){return"[SoundJS SoundChannel]"}};b.defaultSoundInstance=
new function(){this.isDefault=true;this.addEventListener=this.removeEventListener=this.removeAllEventListener=this.dispatchEvent=this.hasEventListener=this._listeners=this.interrupt=this.playFailed=this.pause=this.resume=this.play=this.beginPlaying=this.cleanUp=this.stop=this.setMasterVolume=this.setVolume=this.mute=this.setMute=this.getMute=this.setPan=this.getPosition=this.setPosition=function(){return false};this.getVolume=this.getPan=this.getDuration=function(){return 0};this.playState=b.PLAY_FAILED;
this.toString=function(){return"[SoundJS Default Sound Instance]"}};i.init=function(){var a=navigator.userAgent;i.isFirefox=a.indexOf("Firefox")>-1;i.isOpera=window.opera!=null;i.isChrome=a.indexOf("Chrome")>-1;i.isIOS=a.indexOf("iPod")>-1||a.indexOf("iPhone")>-1||a.indexOf("iPad")>-1};i.init();createjs.SoundJS.BrowserDetect=i;if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){if(this==null)throw new TypeError;var c=Object(this),b=c.length>>>0;if(b===0)return-1;var d=0;arguments.length>
1&&(d=Number(arguments[1]),d!=d?d=0:d!=0&&d!=Infinity&&d!=-Infinity&&(d=(d>0||-1)*Math.floor(Math.abs(d))));if(d>=b)return-1;for(d=d>=0?d:Math.max(b-Math.abs(d),0);d<b;d++)if(d in c&&c[d]===a)return d;return-1}})();this.createjs=this.createjs||{};
(function(){function b(){this.init()}function f(a,c){this.init(a,c)}function i(a,c){this.init(a,c)}b.capabilities=null;b.isSupported=function(){b.generateCapabilities();return b.context==null?false:true};b.generateCapabilities=function(){if(b.capabilities==null){var a=document.createElement("audio");if(a.canPlayType==null)return null;if(window.webkitAudioContext)b.context=new webkitAudioContext;else if(window.AudioContext)b.context=new AudioContext;else return null;b.capabilities={panning:true,volume:true,
tracks:-1};for(var c=0,e=createjs.SoundJS.SUPPORTED_EXTENSIONS.length;c<e;c++){var d=createjs.SoundJS.SUPPORTED_EXTENSIONS[c],g=createjs.SoundJS.EXTENSION_MAP[d]||d;b.capabilities[d]=a.canPlayType("audio/"+d)!="no"&&a.canPlayType("audio/"+d)!=""||a.canPlayType("audio/"+g)!="no"&&a.canPlayType("audio/"+g)!=""}if(b.context.destination.numberOfChannels<2)b.capabilities.panning=false;b.dynamicsCompressorNode=b.context.createDynamicsCompressor();b.dynamicsCompressorNode.connect(b.context.destination);
b.gainNode=b.context.createGainNode();b.gainNode.connect(b.dynamicsCompressorNode)}};b.prototype={capabilities:null,FT:0.0010,volume:1,context:null,dynamicsCompressorNode:null,gainNode:null,arrayBuffers:null,init:function(){this.capabilities=b.capabilities;this.arrayBuffers={};this.context=b.context;this.gainNode=b.gainNode;this.dynamicsCompressorNode=b.dynamicsCompressorNode},register:function(a){this.arrayBuffers[a]=true;return{tag:new i(a,this)}},isPreloadStarted:function(a){return this.arrayBuffers[a]!=
null},isPreloadComplete:function(a){return!(this.arrayBuffers[a]==null||this.arrayBuffers[a]==true)},removeFromPreload:function(a){delete this.owner.arrayBuffers[a]},addPreloadResults:function(a,c){this.arrayBuffers[a]=c},handlePreloadComplete:function(){createjs.SoundJS.sendLoadComplete(this.src)},preload:function(a){this.arrayBuffers[a]=true;a=new i(a,this);a.onload=this.handlePreloadComplete;a.load()},create:function(a){this.isPreloadStarted(a)||this.preload(a);return new f(a,this)},setVolume:function(a){this.volume=
a;return this.updateVolume()},updateVolume:function(){var a=createjs.SoundJS.masterMute?0:this.volume;if(a!=this.gainNode.gain.value)this.gainNode.gain.value=a;return true},getVolume:function(){return this.volume},setMute:function(){return this.updateVolume()},toString:function(){return"[WebAudioPlugin]"}};createjs.WebAudioPlugin=b;f.prototype={src:null,uniqueId:-1,playState:null,preloadState:null,owner:null,loaded:false,lastInterrupt:createjs.SoundJS.INTERRUPT_NONE,offset:0,delay:0,volume:1,pan:0,
duration:0,remainingLoops:0,delayTimeoutId:null,soundCompleteTimeout:null,panNode:null,gainNode:null,sourceNode:null,muted:false,paused:false,startTime:0,onComplete:null,onLoop:null,onReady:null,onPlayFailed:null,onPlayInterrupted:null,endedHandler:null,readyHandler:null,stalledHandler:null,addEventListener:null,removeEventListener:null,removeAllEventListeners:null,dispatchEvent:null,hasEventListener:null,_listeners:null,init:function(a,c){this.owner=c;this.src=a;this.owner.capabilities.panning?(this.panNode=
this.owner.context.createPanner(),this.panNode.connect(this.owner.gainNode)):this.panNode=this.owner.gainNode;this.gainNode=b.context.createGainNode();this.gainNode.connect(this.panNode);if(this.owner.isPreloadComplete(this.src))this.duration=this.owner.arrayBuffers[this.src].duration*1E3;this.endedHandler=createjs.SoundJS.proxy(this.handleSoundComplete,this);this.readyHandler=createjs.SoundJS.proxy(this.handleSoundReady,this);this.stalledHandler=createjs.SoundJS.proxy(this.handleSoundStalled,this)},
sendLoadComplete:function(a){a={target:this,type:a};this._listeners&&this.dispatchEvent(a)},cleanUp:function(){if(this.sourceNode&&this.sourceNode.playbackState!=this.sourceNode.UNSCHEDULED_STATE)this.sourceNode.noteOff(0),this.sourceNode=null;clearTimeout(this.delayTimeoutId);clearTimeout(this.soundCompleteTimeout);window.createjs!=null&&createjs.SoundJS.playFinished(this)},interrupt:function(){this.playState=createjs.SoundJS.PLAY_INTERRUPTED;if(this.onPlayInterrupted)this.onPlayInterrupted(this);
this.sendLoadComplete("playInterrupted");this.cleanUp();this.paused=false},play:function(a,c,b,d,g,h){this.cleanUp();createjs.SoundJS.playInstance(this,a,c,b,d,g,h)},beginPlaying:function(a,c,b,d){if(window.createjs!=null&&this.src)if(this.offset=a/1E3,this.remainingLoops=c,this.setVolume(b),this.setPan(d),this.owner.isPreloadComplete(this.src))return this.handleSoundReady(null),this.sendLoadComplete("playSucceeded"),1;else this.playFailed()},handleSoundStalled:function(){if(this.onPlayFailed!=null)this.onPlayFailed(this);
this.sendLoadComplete("playFailed")},handleSoundReady:function(){if(window.createjs!=null)if(this.offset>this.getDuration())this.playFailed();else{if(this.offset<0)this.offset=0;this.playState=createjs.SoundJS.PLAY_SUCCEEDED;this.paused=false;this.sourceNode=this.owner.context.createBufferSource();this.sourceNode.buffer=this.owner.arrayBuffers[this.src];this.duration=this.owner.arrayBuffers[this.src].duration*1E3;this.sourceNode.connect(this.gainNode);this.soundCompleteTimeout=setTimeout(this.endedHandler,
(this.sourceNode.buffer.duration-this.offset)*1E3);this.startTime=this.owner.context.currentTime-this.offset;this.sourceNode.noteGrainOn(0,this.offset,this.sourceNode.buffer.duration-this.offset)}},pause:function(){this.paused=true;this.offset=this.owner.context.currentTime-this.startTime;this.sourceNode.noteOff(0);clearTimeout(this.delayTimeoutId);clearTimeout(this.soundCompleteTimeout);return true},resume:function(){this.handleSoundReady(null);return true},stop:function(){this.playState=createjs.SoundJS.PLAY_FINISHED;
this.cleanUp();this.offset=0;return true},setVolume:function(a){this.volume=a;this.updateVolume();return true},updateVolume:function(){var a=this.muted?0:this.volume;if(a!=this.gainNode.gain.value)this.gainNode.gain.value=a;return true},getVolume:function(){return this.volume},mute:function(a){this.muted=a;this.updateVolume();return true},setMute:function(a){if(a==null||a==void 0)return false;this.muted=a;this.updateVolume();return true},getMute:function(){return this.muted},setPan:function(a){if(this.owner.capabilities.panning)this.panNode.setPosition(a,
0,-0.5),this.pan=a;else return false},getPan:function(){return this.pan},getPosition:function(){return(this.paused||this.sourceNode==null?this.offset:this.owner.context.currentTime-this.startTime)*1E3},setPosition:function(a){this.offset=a/1E3;this.sourceNode&&this.sourceNode.playbackState!=this.sourceNode.UNSCHEDULED_STATE&&(this.sourceNode.noteOff(0),clearTimeout(this.soundCompleteTimeout));!this.paused&&this.playState==createjs.SoundJS.PLAY_SUCCEEDED&&this.handleSoundReady(null);return true},getDuration:function(){return this.duration},
handleSoundComplete:function(){if(this.remainingLoops!=0){if(this.remainingLoops--,this.offset=0,this.handleSoundReady(null),this.onLoop!=null)this.onLoop(this)}else if(window.createjs!=null){this.playState=createjs.SoundJS.PLAY_FINISHED;if(this.onComplete!=null)this.onComplete(this);this.sendLoadComplete("playComplete");this.cleanUp()}},playFailed:function(){if(window.createjs!=null){this.playState=createjs.SoundJS.PLAY_FAILED;if(this.onPlayFailed!=null)this.onPlayFailed(this);this.sendLoadComplete("playFailed");
this.cleanUp()}},toString:function(){return"[WebAudioPlugin SoundInstance]"}};createjs.EventDispatcher&&createjs.EventDispatcher.initialize(f.prototype);i.prototype={request:null,owner:null,progress:-1,src:null,result:null,onload:null,onprogress:null,onError:null,init:function(a,c){this.src=a;this.owner=c},load:function(a){if(a!=null)this.src=a;this.request=new XMLHttpRequest;this.request.open("GET",this.src,true);this.request.responseType="arraybuffer";this.request.onload=createjs.SoundJS.proxy(this.handleLoad,
this);this.request.onError=createjs.SoundJS.proxy(this.handleError,this);this.request.onprogress=createjs.SoundJS.proxy(this.handleProgress,this);this.request.send()},handleProgress:function(a,c){this.progress=a/c;if(this.onprogress!=null)this.onprogress({loaded:a,total:c,progress:this.progress})},handleLoad:function(){b.context.decodeAudioData(this.request.response,createjs.SoundJS.proxy(this.handleAudioDecoded,this),createjs.SoundJS.proxy(this.handleError,this))},handleAudioDecoded:function(a){this.progress=
1;this.result=a;this.owner.addPreloadResults(this.src,this.result);this.onload&&this.onload()},handleError:function(a){this.owner.removeFromPreload(this.src);this.onerror&&this.onerror(a)},toString:function(){return"[WebAudioPlugin WebAudioLoader]"}}})();this.createjs=this.createjs||{};
(function(){function b(){this.init()}function f(a,b){this.init(a,b)}function i(a,b){this.init(a,b)}function a(a){this.init(a)}b.MAX_INSTANCES=30;b.capabilities=null;b.tagVolume=null;b.AUDIO_READY="canplaythrough";b.AUDIO_ENDED="ended";b.AUDIO_ERROR="error";b.AUDIO_STALLED="stalled";b.fillChannels=false;b.isSupported=function(){if(createjs.SoundJS.BrowserDetect.isIOS)return false;b.generateCapabilities();return b.tag==null||b.capabilities==null?false:true};b.generateCapabilities=function(){if(b.capabilities==
null){var a=b.tag=document.createElement("audio");if(a.canPlayType==null)return null;b.capabilities={panning:true,volume:true,tracks:-1};for(var e=0,d=createjs.SoundJS.SUPPORTED_EXTENSIONS.length;e<d;e++){var g=createjs.SoundJS.SUPPORTED_EXTENSIONS[e],h=createjs.SoundJS.EXTENSION_MAP[g]||g;b.capabilities[g]=a.canPlayType("audio/"+g)!="no"&&a.canPlayType("audio/"+g)!=""||a.canPlayType("audio/"+h)!="no"&&a.canPlayType("audio/"+h)!=""}}};b.prototype={capabilities:null,FT:0.0010,audioSources:null,init:function(){this.capabilities=
b.capabilities;this.audioSources={}},register:function(b,e){this.audioSources[b]=true;for(var d=a.get(b),g,h=0,f=e||1;h<f;h++)g=this.createTag(b),d.add(g);return{tag:g}},createTag:function(a){var b=document.createElement("audio");b.preload=false;b.src=a;return b},create:function(b){if(!this.preloadStarted(b)){var e=a.get(b),d=this.createTag(b);e.add(d);this.preload(b,{tag:d})}return new f(b,this)},preloadStarted:function(a){return this.audioSources[a]!=null},preload:function(a,b){this.audioSources[a]=
true;new i(a,b.tag)},toString:function(){return"[HTMLAudioPlugin]"}};createjs.HTMLAudioPlugin=b;f.prototype={src:null,uniqueId:-1,playState:null,owner:null,loaded:false,lastInterrupt:createjs.SoundJS.INTERRUPT_NONE,offset:0,delay:0,volume:1,pan:0,duration:0,remainingLoops:0,delayTimeoutId:null,tag:null,muted:false,paused:false,onComplete:null,onLoop:null,onReady:null,onPlayFailed:null,onPlayInterrupted:null,endedHandler:null,readyHandler:null,stalledHandler:null,addEventListener:null,removeEventListener:null,
removeAllEventListeners:null,dispatchEvent:null,hasEventListener:null,_listeners:null,init:function(a,b){this.src=a;this.owner=b;this.endedHandler=createjs.SoundJS.proxy(this.handleSoundComplete,this);this.readyHandler=createjs.SoundJS.proxy(this.handleSoundReady,this);this.stalledHandler=createjs.SoundJS.proxy(this.handleSoundStalled,this)},sendLoadComplete:function(a){a={target:this,type:a};this._listeners&&this.dispatchEvent(a)},cleanUp:function(){var b=this.tag;if(b!=null){b.pause();try{b.currentTime=
0}catch(e){}b.removeEventListener(createjs.HTMLAudioPlugin.AUDIO_ENDED,this.endedHandler,false);b.removeEventListener(createjs.HTMLAudioPlugin.AUDIO_READY,this.readyHandler,false);a.setInstance(this.src,b);this.tag=null}clearTimeout(this.delayTimeoutId);window.createjs!=null&&createjs.SoundJS.playFinished(this)},interrupt:function(){if(this.tag!=null){this.playState=createjs.SoundJS.PLAY_INTERRUPTED;if(this.onPlayInterrupted)this.onPlayInterrupted(this);this.sendLoadComplete("playInterrupted");this.cleanUp();
this.paused=false}},play:function(a,b,d,g,h,f){this.cleanUp();createjs.SoundJS.playInstance(this,a,b,d,g,h,f)},beginPlaying:function(b,e,d){if(window.createjs==null)return-1;var g=this.tag=a.getInstance(this.src);if(g==null)return this.playFailed(),-1;this.duration=this.tag.duration*1E3;g.addEventListener(createjs.HTMLAudioPlugin.AUDIO_ENDED,this.endedHandler,false);this.offset=b;this.volume=d;this.updateVolume();this.remainingLoops=e;g.readyState!==4?(g.addEventListener(createjs.HTMLAudioPlugin.AUDIO_READY,
this.readyHandler,false),g.addEventListener(createjs.HTMLAudioPlugin.AUDIO_STALLED,this.stalledHandler,false),g.load()):this.handleSoundReady(null);this.sendLoadComplete("playSucceeded");return 1},handleSoundStalled:function(){if(this.onPlayFailed!=null)this.onPlayFailed(this);this.sendLoadComplete("playFailed");this.cleanUp()},handleSoundReady:function(){if(window.createjs!=null)if(this.playState=createjs.SoundJS.PLAY_SUCCEEDED,this.paused=false,this.tag.removeEventListener(createjs.HTMLAudioPlugin.AUDIO_READY,
this.readyHandler,false),this.offset>=this.getDuration())this.playFailed();else{if(this.offset>0)this.tag.currentTime=this.offset*0.0010;if(this.remainingLoops==-1)this.tag.loop=true;this.tag.play()}},pause:function(){this.paused=true;clearTimeout(this.delayTimeoutId);return this.tag!=null?(this.tag.pause(),false):true},resume:function(){this.paused=false;return this.tag!=null?(this.tag.play(),false):true},stop:function(){this.offset=0;this.pause();this.playState=createjs.SoundJS.PLAY_FINISHED;this.cleanUp();
return true},setMasterVolume:function(){this.updateVolume();return true},setVolume:function(a){this.volume=a;this.updateVolume();return true},updateVolume:function(){if(this.tag!=null){var a=this.muted||createjs.SoundJS.masterMute?0:this.volume*createjs.SoundJS.masterVolume;if(a!=this.tagVolume)this.tagVolume=this.tag.volume=a;return true}else return false},getVolume:function(){return this.volume},mute:function(a){this.muted=a;this.updateVolume();return true},setMasterMute:function(){this.updateVolume();
return true},setMute:function(a){if(a==null||a==void 0)return false;this.muted=a;this.updateVolume();return true},getMute:function(){return this.muted},setPan:function(){return false},getPan:function(){return 0},getPosition:function(){return this.tag==null?this.offset:this.tag.currentTime*1E3},setPosition:function(a){if(this.tag==null)this.offset=a;else try{this.tag.currentTime=a*0.0010}catch(b){return false}return true},getDuration:function(){return this.duration},handleSoundComplete:function(){if(this.remainingLoops!=
0){if(this.remainingLoops--,this.offset=0,this.tag.play(),this.onLoop!=null)this.onLoop(this)}else if(window.createjs!=null){this.playState=createjs.SoundJS.PLAY_FINISHED;if(this.onComplete!=null)this.onComplete(this);this.sendLoadComplete("playComplete");this.cleanUp()}},playFailed:function(){if(window.createjs!=null){this.playState=createjs.SoundJS.PLAY_FAILED;if(this.onPlayFailed!=null)this.onPlayFailed(this);this.sendLoadComplete("playFailed");this.cleanUp()}},toString:function(){return"[HTMLAudioPlugin SoundInstance]"}};
createjs.EventDispatcher&&createjs.EventDispatcher.initialize(f.prototype);i.prototype={src:null,tag:null,preloadTimer:null,loadedHandler:null,init:function(a,b){this.src=a;this.tag=b;this.preloadTimer=setInterval(createjs.SoundJS.proxy(this.preloadTick,this),200);this.loadedHandler=createjs.SoundJS.proxy(this.sendLoadedEvent,this);this.tag.addEventListener&&this.tag.addEventListener("canplaythrough",this.loadedHandler);this.tag.onreadystatechange=createjs.SoundJS.proxy(this.sendLoadedEvent,this);
this.tag.preload="auto";this.tag.src=a;this.tag.load()},preloadTick:function(){var a=this.tag.buffered,b=this.tag.duration;a.length>0&&a.end(0)>=b-1&&this.handleTagLoaded()},handleTagLoaded:function(){clearInterval(this.preloadTimer)},sendLoadedEvent:function(){this.tag.removeEventListener&&this.tag.removeEventListener("canplaythrough",this.loadedHandler);this.tag.onreadystatechange=null;createjs.SoundJS.sendLoadComplete(this.src)},toString:function(){return"[HTMLAudioPlugin HTMLAudioLoader]"}};a.tags=
{};a.get=function(b){var e=a.tags[b];e==null&&(e=a.tags[b]=new a(b));return e};a.getInstance=function(b){b=a.tags[b];return b==null?null:b.get()};a.setInstance=function(b,e){var d=a.tags[b];return d==null?null:d.set(e)};a.prototype={src:null,length:0,available:0,tags:null,init:function(a){this.src=a;this.tags=[]},add:function(a){this.tags.push(a);this.length++;this.available++},get:function(){if(this.tags.length==0)return null;this.available=this.tags.length;var a=this.tags.pop();a.parentNode==null&&
document.body.appendChild(a);return a},set:function(a){this.tags.indexOf(a)==-1&&this.tags.push(a);this.available=this.tags.length},toString:function(){return"[HTMLAudioPlugin TagPool]"}}})();this.createjs=this.createjs||{};
(function(){function b(a,b,e){this.f=a;this.scope=b;this.priority=e}var f=function(){this.initialize()},i=f.prototype;f.initialize=function(a){a.addEventListener=i.addEventListener;a.removeEventListener=i.removeEventListener;a.removeAllEventListeners=i.removeAllEventListeners;a.hasEventListener=i.hasEventListener;a.dispatchEvent=i.dispatchEvent};i._listeners=null;i.initialize=function(){};i.addEventListener=function(a,c,e,d){var d=d||0,g=new b(c,e||this,d),h=this._listeners;if(!h)h=this._listeners=
{};var f=h[a];if(f){this.removeEventListener(a,c,e);a=0;for(c=f.length;a<c&&f[a].priority>=d;a++);f.splice(a,0,g)}else h[a]=[g]};i.removeEventListener=function(a,b,e){var d=this._listeners;if(d){var g=d[a];if(g)for(var e=e||this,f=0,i=g.length;f<i;f++){var j=g[f];if(j.f==b&&j.scope==e){i==1?delete d[a]:g.splice(f,1);break}}}};i.removeAllEventListeners=function(a){a?this._listeners&&delete this._listeners[a]:this._listeners=null};i.dispatchEvent=function(a,b,e){b&&b.apply(this,e);var b=false,d=this._listeners;
if(a&&d){typeof a=="string"&&(a={type:a,params:e});e=d[a.type];if(!e)return b;for(var d=0,g=e.length;d<g;d++)var f=e[d],b=b||f.f.apply(f.scope,[a])}return!!b};i.hasEventListener=function(a,b){return!!(b||this._listeners&&this._listeners[a])};i.toString=function(){return"[EventDispatcher]"};createjs.EventDispatcher=f})();
